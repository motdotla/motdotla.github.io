---
layout: default
title: Deployment
---

<time>2015-08-05</time>

<h2>Deploying NodeJS to Amazon EC2</h2>

<img src="images/deployment.jpg"/>

<p>Node.js is cool. Amazon EC2 is cool. In this tutorial, I show you how to make
your deployment cool. I describe the single best way to deploy your Node.js
applications to Amazon EC2.</p>

<p>Begin by cloning 
<a href="https://github.com/motdotla/ec2-on-node">ec2-on-node</a>. You will
need to already be familiar with git. [0]</p>

<p>Next visit 
<a href="https://us-west-1.console.aws.amazon.com/elasticbeanstalk/home">Amazon Elastic Beanstalk</a>. 
You will need to already have an Amazon Web Services account. [1]</p>

<p>Click <a href="https://us-west-1.console.aws.amazon.com/elasticbeanstalk/home?region=us-west-1#/newApplication">Create New Application</a> 
at the top right.</p>

<a href="images/deploy/0.png" target="_blank">
  <img src="images/deploy/0.png"/>
</a>

<p>Name your application `ec2-on-node` and click Next.</p>

<a href="images/deploy/1.png" target="_blank">
  <img src="images/deploy/1.png"/>
</a>

<p>Click the `Create Web Server` button.</p>

<a href="images/deploy/2.png" target="_blank">
  <img src="images/deploy/2.png"/>
</a>

<p>Choose the `Create an IAM Role and instance profile` on the popup modal.</p>

<a href="images/deploy/3.png" target="_blank">
  <img src="images/deploy/3.png"/>
</a>

<p>On the next screen choose `Docker` and `Load balancing, auto scaling`.
Click Next.</p>

<a href="images/deploy/4.png" target="_blank">
  <img src="images/deploy/4.png"/>
</a>

<p>Upload your application. Click `Choose File` and then find the 
`ec2-on-node.zip` file. It is inside the repository you cloned at the beginning 
of this tutorial. Leave the other settings the same and click Next.</p>

<a href="images/deploy/5.png" target="_blank">
  <img src="images/deploy/5.png"/>
</a>

<p>On the next screen choose an environment name and environment url.</p>

<a href="images/deploy/6.png" target="_blank">
  <img src="images/deploy/6.png"/>
</a>

<p>On the next screen keep the default settings and click Next.</p>

<a href="images/deploy/7.png" target="_blank">
  <img src="images/deploy/7.png"/>
</a>

<p>On the next screen keep the default settings - excepting the addition of a
`/` to the Application Health Check URL setting. Click Next.</p>

<a href="images/deploy/8.png" target="_blank">
  <img src="images/deploy/8.png"/>
</a>

<p>Click Next through the Environment Tags section. Lastly, on the Review page,
click `Launch`.</p>

<a href="images/deploy/9.png" target="_blank">
  <img src="images/deploy/9.png"/>
</a>

<p>It will take about 5 minutes to finish deployment. </p>

<a href="images/deploy/10.png" target="_blank">
  <img src="images/deploy/10.png"/>
</a>

<p></p>

<a href="images/deploy/11.png" target="_blank">
  <img src="images/deploy/11.png"/>
</a>

<p></p>

<a href="images/deploy/12.png" target="_blank">
  <img src="images/deploy/12.png"/>
</a>

[0] You can learn git at <a href="https://try.github.io">try.github.io</a>
[1] You can signup for free at <a href="http://aws.amazon.com/free">aws.amazon.com/free</a>

+ GitHub
  + Host on GitHub
+ App
  + Nodejs
  + See example application
+ Setup npm test running on codeship
  + package.json/scripts/test 
  + set example commands [1]
  + set test commands [2]
+ Setup Elastic Beanstalk environment
  + Click create new application
  + name it api
  + now create environment - staging
+ Setup deployment on codeship
  + Add new deployment pipeline. Choose 'master'
  + Choose Amazon Elastic Beanstalk
  + Set an Access Key ID, secret key, choose region, and set application name, environment name, and S3 bucket

  
  + Dockerfile
+ Codeship
  + Setup to run your tests
  + Configure codeship with amazon elastic beanstalk
+ Setup Elastic Beanstalk
  + 


[1]
```
nvm install iojs-v1.8.4
nvm use iojs-v1.8.4
npm install
```

[2]
```
npm test --coverage
```
